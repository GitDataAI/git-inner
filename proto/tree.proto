syntax = "proto3";
import "share.proto";

package gitfs;


service TreeService {
  rpc GetCurrentTree(TreeCurrentRequest) returns (TreeCurrentResponse);
  rpc GetCommitTree(CommitTreeRequest) returns (CommitTreeResponse);
}

message TreeCurrentRequest {
  RpcRepository repository = 1;
  string path = 2; // 新增：查询指定目录（以仓库根为基准），空或 "/" 表示根目录
  optional string revision = 3;
  string refs = 4;
}

message TreeCurrentResponse {
  repeated TreeMessage items = 1;
}

message TreeMessage {
  RpcTreeItem item = 1;
  RpcCommit commit = 2;
}

message CommitTreeRequest {
  RpcRepository repository = 1;
  string commit_hash = 2;
  string path = 3; // 新增：查询指定目录（以仓库根为基准），空或 "/" 表示根目录
}

message CommitTreeResponse {
  RpcTree tree = 1;
}
